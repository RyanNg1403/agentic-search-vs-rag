
MCP OAuth provider in packages/core/src/mcp/oauth-provider.ts handles OAuth authentication for MCP servers. MCPOAuthProvider class manages OAuth flow with PKCE support. You must configure MCPOAuthConfig with clientId, clientSecret, authorizationUrl, tokenUrl, scopes, and redirectUri. Token storage uses MCPOAuthTokenStorage for persistent credential management. The provider supports dynamic client registration (RFC 7591) via registerClient(). Tokens are automatically refreshed when expired using refresh tokens. For SSE connections, use tokenParamName to specify query parameter. Security: always validate state parameter to prevent CSRF attacks.
